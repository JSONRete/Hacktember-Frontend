{"version":3,"sources":["../../../src/utils/localStorageBroadcastChannel.test.ts"],"sourcesContent":["import { LocalStorageBroadcastChannel } from './localStorageBroadcastChannel';\n\nconst bcName = 'clerk';\n\ndescribe('LocalStorageBroadcastChannel', () => {\n  let localStorageMock;\n  beforeEach(() => {\n    localStorageMock = (() => {\n      const store: Record<string, any> = {};\n      return {\n        setItem: jest.fn((key, value) => {\n          store[key] = value;\n          window.dispatchEvent(new StorageEvent('storage', { key, newValue: value }));\n        }),\n        removeItem: jest.fn(key => {\n          store[key] = undefined;\n          window.dispatchEvent(new Event('storage'));\n        }),\n      };\n    })();\n    Object.defineProperty(window, 'localStorage', { value: localStorageMock });\n  });\n\n  it('notifies other LocalStorageBroadcastChannel with same name', () => {\n    const tab1ClerkBCListener = jest.fn();\n    const tab1DifferentBCListener = jest.fn();\n    const tab2ClerkBCListener = jest.fn();\n\n    const tab1ClerkBC = new LocalStorageBroadcastChannel(bcName);\n    const tab1DifferentBC = new LocalStorageBroadcastChannel('somethingElse');\n    const tab2ClerkBC = new LocalStorageBroadcastChannel(bcName);\n\n    tab1ClerkBC.addEventListener('message', tab1ClerkBCListener);\n    tab1DifferentBC.addEventListener('message', tab1DifferentBCListener);\n    tab2ClerkBC.addEventListener('message', tab2ClerkBCListener);\n\n    const message = 'a message from tab1';\n    tab1ClerkBC.postMessage(message);\n    expect(tab1DifferentBCListener).not.toHaveBeenCalled();\n    expect(tab2ClerkBCListener).toHaveBeenCalled();\n  });\n});\n"],"mappings":";AAAA,0CAA6C;AAE7C,MAAM,SAAS;AAEf,SAAS,gCAAgC,MAAM;AAC7C,MAAI;AACJ,aAAW,MAAM;AACf,wBAAoB,MAAM;AACxB,YAAM,QAA6B,CAAC;AACpC,aAAO;AAAA,QACL,SAAS,KAAK,GAAG,CAAC,KAAK,UAAU;AAC/B,gBAAM,GAAG,IAAI;AACb,iBAAO,cAAc,IAAI,aAAa,WAAW,EAAE,KAAK,UAAU,MAAM,CAAC,CAAC;AAAA,QAC5E,CAAC;AAAA,QACD,YAAY,KAAK,GAAG,SAAO;AACzB,gBAAM,GAAG,IAAI;AACb,iBAAO,cAAc,IAAI,MAAM,SAAS,CAAC;AAAA,QAC3C,CAAC;AAAA,MACH;AAAA,IACF,GAAG;AACH,WAAO,eAAe,QAAQ,gBAAgB,EAAE,OAAO,iBAAiB,CAAC;AAAA,EAC3E,CAAC;AAED,KAAG,8DAA8D,MAAM;AACrE,UAAM,sBAAsB,KAAK,GAAG;AACpC,UAAM,0BAA0B,KAAK,GAAG;AACxC,UAAM,sBAAsB,KAAK,GAAG;AAEpC,UAAM,cAAc,IAAI,iEAA6B,MAAM;AAC3D,UAAM,kBAAkB,IAAI,iEAA6B,eAAe;AACxE,UAAM,cAAc,IAAI,iEAA6B,MAAM;AAE3D,gBAAY,iBAAiB,WAAW,mBAAmB;AAC3D,oBAAgB,iBAAiB,WAAW,uBAAuB;AACnE,gBAAY,iBAAiB,WAAW,mBAAmB;AAE3D,UAAM,UAAU;AAChB,gBAAY,YAAY,OAAO;AAC/B,WAAO,uBAAuB,EAAE,IAAI,iBAAiB;AACrD,WAAO,mBAAmB,EAAE,iBAAiB;AAAA,EAC/C,CAAC;AACH,CAAC;","names":[]}